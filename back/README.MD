<p align="center">
    <img src="https://pbs.twimg.com/profile_images/575314188848889856/F4KWmvVX_200x200.png" alt="Header - complaints">
</p>
<p align="center">
    complaints
</p>

## Sobre o projeto
O projeto visa desenvolver um sistema integrado para a gestÃ£o de reclamaÃ§Ãµes(complaints)

## Stack do projeto

Este projeto Ã© uma applicaÃ§Ã£o web que implementa uma API REST usando o framework FastAPI sem banco de dados real.

Essas e outras libs e tecnologias usadas neste projeto sÃ£o:
|  Lib      | VersÃ£o    |
|-----------|-----------|
| **Runtime**           |
| Python    | v3.11.x   |
| FastAPI   | v0.111.x  |
| Uvicorn   | v.0.29.x  |
| Pydantic  | v2.7.x    |
| **Devtime**           |
| Pytest                        | v8.2.x    |
| Pytest Coverage (pytest-cov)  | v5.0.x    |


### OrganizaÃ§Ã£o do projeto
```
â”œâ”€ğŸ“ Desafio-FullStack-nina
/
â”œâ”€ğŸ“ back             ->  [ImplementaÃ§Ã£o da API]
â”‚   â”œâ”€ğŸ app.py     ->  [Entrypoint da aplicaÃ§Ã£o]
â”‚   â”œâ”€ğŸ“ routers            ->  [rotas da aplicaÃ§Ã£o]
â”‚   â”‚ â”‚ â”œâ”€ğŸ complaints.py
â”‚   â”‚ â”‚ â”œâ”€ğŸ users.py
â”‚   â”‚   ...
â”‚   â””â”€ğŸ“ schema    ->  [schemas da aplicaÃ§Ã£o]
â”‚   â”‚ â”‚ â”œâ”€ğŸ complaints.py
â”‚   â”‚ â”‚ â”œâ”€ğŸ users.py
â”‚   â”‚   ...
â”‚   â””â”€ğŸ“ database      ->  [configuraÃ§Ãµes dos dados da aplicaÃ§Ã£o]
â”‚   â”‚ â”‚ â”œâ”€ğŸ database.py
â”‚   â”‚ â”‚ â”œâ”€ğŸ db_exception.py
â”‚   â”‚ â”‚ â”œâ”€ğŸ generate_mocked_data.py
â”‚   â”‚ â”‚ â”œâ”€{...} mocked_exemple.json
â”‚        ...
â”œâ”€ğŸ“ tests           ->  [Testes da aplicaÃ§Ã£o]
â”‚   â”œâ”€ğŸ conftest.py ->  [configuraÃ§Ã£o do ambiente de testes.]
â”‚   â”œâ”€ğŸ test_nome-modulo.py ->  [nomeclatura dos testes pytest.]
â”‚                     
â”œâ”€ğŸ“„ .gitignore
â”œâ”€ğŸ“„ requirements.txt  ->  [DefiniÃ§Ãµes para o projeto]
â”œâ”€ğŸ“„ README.md

```

## Rodando a API

Este repositÃ³rio estÃ¡ organizado para rodar com Docker ou localmente. Para iniciar, siga as seguintes configuraÃ§Ãµes:

### ConfiguraÃ§Ãµes Locais

Este projeto utiliza o pip para gerenciar as dependÃªncias definidas no arquivo `requirements.txt`.

crie o ambiente virtual executando (caso esteja dentro da pasta back):
```sh
python3 -m venv venv
```

ative o ambiente virtual executando (caso esteja dentro da pasta back):
```sh
source venv/bin/activate
```

Para instalar as dependÃªncias, utilize o comando (caso esteja dentro da pasta back):
```sh
pip install -r requirements.txt
```


ApÃ³s isso, o projeto estarÃ¡ pronto para ser iniciado com o comando:
```sh
make run 
```

<!-- FIXME: AINDA Ã‰ NECESSARIO IMPLEMENTAR O dockerfile do back e front e o compose para rodar os dois -->
<!-- FIXME: AINDA Ã‰ NECESSARIO IMPLEMENTAR O MAKE -->
### ConfiguraÃ§Ãµes com Docker (volte para pasta principal [Desafio-FullStack-nina] )

Ã‰ obrigatÃ³rio ter o Docker Engine jÃ¡ instalado e configurado. Para mais informaÃ§Ãµes de como instalar o Docker Engine em seu sistema operacional, consulte:

- [InstruÃ§Ãµes para instalaÃ§Ã£o do Docker Engine](https://docs.docker.com/engine/install/)

#### Principais Comandos

##### Subir o Compose

```sh
docker compose up
```

##### Executar as MigraÃ§Ãµes do Alembic
> **Nota:** Para entrar em um container Docker de forma interativa, vocÃª pode usar o seguinte comando:
```sh
docker exec -it <nome_container> /bin/bash
```

Dentro do container, execute:

##### Executar Testes
```sh
make test
```

# Lista de Atividades 

## Atividades Pendentes Backend
- [ ] Implementar um recurso ausente que retorne todas as reclamaÃ§Ãµes de um determinado usuÃ¡rio.


## Atividades ConcluÃ­das Backend
- [v] Implementar uma funcionalidade de filtragem para a rota get_complaints (```/complaints```) permitindo que ela retorne apenas as reclamaÃ§Ãµes onde o campo ```date``` estÃ¡ entre os campos ```from_date``` e `` `to_date```, passado atravÃ©s de parÃ¢metros de consulta.
> **Nota:** serÃ¡ necessÃ¡rio para integraÃ§Ã£o com a tabela de complaints(reclamaÃ§Ãµes) no frontend

> **Comentario 1:** Como estamos trabalhando em memoria e a quantidade de dados Ã© pequena algumas implementaÃ§Ãµes sÃ£o rapidas pela definiÃ§Ã£o de responsabilidades e durabilidade dos dados guardar coisas em memÃ³ria nÃ£o Ã© uma boa coisa pois depende que a aplicaÃ§Ã£o fique 100% ligada para que um post dure por exemplo.

> **Comentario 2:** Foi detectado um warning ao rodar a aplicaÃ§Ã£o fastapi (UserWarning: Valid config keys have changed) solicitando a troca da nomeclatura (allow_population_by_field_name) para populate_by_name

> **Comentario 3:** Foi detectado um uso Deprecated(relacionado ao uso de configuraÃ§Ãµes baseadas em classes) no schema de pydantic na hora de rodar os testes e esse warning se encontra no group_bys schema

- [v] Refatore a rota get_complaint (```/complaint/{complaint_id}```) para que a reclamaÃ§Ã£o retornada inclua informaÃ§Ãµes sobre o usuÃ¡rio que a registrou. 
> **Nota:** serÃ¡ necessÃ¡rio para integraÃ§Ã£o com a tabela de complaints(reclamaÃ§Ãµes) no frontend

> **Comentario 1:** Foi adicionado um parametro UserSchema opcional no schema de  complaints(reclamaÃ§Ãµes) para que o response_model se adeque ao que foi solicitado

> **Comentario 2:** talvez seja necessario refatorar para que a logica de junÃ§Ã£o complaint e usuÃ¡rio fiquem no proprio controller get_complaint

## Atividades Extras 

- [ ] Dockerfile

- [v] testes back-end (usando pytest)
> **Nota de ImplementaÃ§Ã£o:** Durante o desenvolvimento, infrentei um desafio relacionado Ã  configuraÃ§Ã£o do ambiente de desenvolvimento com FastAPI. A execuÃ§Ã£o do servidor de desenvolvimento utilizando o comando `fastapi dev app.py` ou `fastapi dev back/app.py` resultava em impossibilidade na execuÃ§Ã£o dos testes do pytest. Isso ocorreu porque o comando `fastapi dev` exige que os caminhos dos mÃ³dulos sejam especificados de uma forma (por exemplo, `from back.router import users, complaints`), enquanto o `pytest` requer uma estrutura de importaÃ§Ã£o diferente (ou seja, `from routers import users, complaints`). Para resolver essa incompatibilidade e garantir a integridade dos testes, optamos por utilizar o `uvicorn` para iniciar o servidor de desenvolvimento, com o comando `uvicorn app:app --reload --host 0.0.0.0`. Essa abordagem me permitiu manter os testes enquanto desenvolvÃ­amos com FastAPI.

- [ ] adicionar o coverage (pytest-cov)
